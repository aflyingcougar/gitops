---
apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: authentik-db
spec:
  values:
    fullnameOverride: "authentik-db"
    global:
      postgresql:
        auth:
          postgresPassword: "${AUTHENTIK_POSTGRES_ROOT_PASSWORD}"
          username: "authentik"
          password: "${AUTHENTIK_POSTGRES_PASSWORD}"
          database: "authentik"
    primary:
      resources:
        limits:
          memory: 512Mi
          cpu: 500m
        requests:
          memory: 256Mi
          cpu: 250m
      podSecurityContext:
        enabled: true
        runAsNonRoot: true
        fsGroup: 1100
      containerSecurityContext:
        enabled: true
        runAsUser: 1100
      persistence:
        enabled: true
        existingClaim: "authentik-db-rook"
